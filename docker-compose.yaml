services:
  # backend:
  #   container_name: indoor-backend
  #   build:
  #     context: ./backend
  #     dockerfile: ./.docker/Dockerfile
      

  # #   environment:
  # #     - MONGODB_URI=mongodb://mongo:27017/test
  # #     - MONGODB_URI=mongodb://root:test@mongo:27017/
  # #     - LOCALSTACK_URL=http://localstack:4566     
  # #     - NODE_ENV=development
  # #   ports:
  # #     - "3000:3000"
  #   environment:
  #     NODE_ENV: production

  #   depends_on:
  #     - mongo
  #     - localstack
      
  #   volumes:
  #     - ./backend/dist:/app/dist
  #     - ./backend/node_modules:/app/node_modules
  #     - ./backend/.env:/app/.env

  #   command: ["npm", "run", "dev"]

  mongo:
    container_name: indoor-mongo
    image: mongo
    ports:
      - "27017:27017"
    volumes:
      - mongodbdata:/data/db
    # environment:
    #   MONGO_INITDB_ROOT_USERNAME: root
    #   MONGO_INITDB_ROOT_PASSWORD: test

      
  localstack:
    container_name: indoor-localstack
    image: localstack/localstack

    environment:
      - DEBUG=1
      - LS_LOG=info  # override DEBUG
      - SERVICES=s3,sqs
    ports:
      - "4566:4566"
      - "4571:4571"
      - "4510-4559:4510-4559"
    # ports:
    #   - "127.0.0.1:4566:4566"
    #   - "127.0.0.1:4510-4559:4510-4559"  
    # environment:
    #   - DEBUG=1
    #   - GATEWAY_LISTEN=0.0.0.0:4566
    #   - LOCALSTACK_HOST=localhost.localstack.cloud:4566
    #   - LS_LOG=info  # override DEBUG
    #   - SERVICES=s3,ec2,apigateway
    #   - DOCKER_SOCK=/var/run/docker.sock
    #   - LOCALSTACK_VOLUME_DIR=./.localstack
    volumes:
      - "./.localstack:/var/lib/localstack"
      - "/var/run/docker.sock:/var/run/docker.sock"

volumes:
  mongodbdata:
